# Настройка платежей через ЮKassa

## Переменные окружения

Добавьте следующие переменные в ваш `.env` файл:

```env
# YooKassa
YOOKASSA_SHOP_ID=your_yookassa_shop_id
YOOKASSA_SECRET_KEY=your_yookassa_secret_key
YOOKASSA_WEBHOOK_SECRET=your_webhook_secret
BASE_URL=http://localhost:3000
```

## Настройка ЮKassa

1. Зарегистрируйтесь в [ЮKassa](https://yookassa.ru/)
2. Получите `shopId` и `secretKey` в личном кабинете
3. Настройте webhook URL: `https://yourdomain.com/api/payment/webhook`
4. Установите webhook secret для проверки подписи

## Установка зависимостей

```bash
npm install yookassa
```

## Как это работает

1. Пользователь нажимает на монетку в интерфейсе
2. Вводит количество монет для пополнения (1-10,000)
3. Нажимает "Пополнить"
4. Создается платеж в ЮKassa (1 монета = 1 копейка)
5. Пользователь перенаправляется на страницу оплаты ЮKassa
6. После успешной оплаты пользователь возвращается на `/payment/success`
7. Монеты автоматически начисляются на баланс
8. Webhook от ЮKassa подтверждает платеж

## Безопасность

- Все платежи проверяются через API ЮKassa
- Дублирование платежей предотвращается через проверку `paymentId`
- Webhook подпись проверяется (закомментировано для разработки)
- Максимальная сумма за транзакцию: 10,000 монет (100 рублей)

## Тестирование

Для тестирования используйте тестовые данные ЮKassa:
- Номер карты: 5555 5555 5555 4444
- Срок действия: любая будущая дата
- CVV: любой трехзначный код
